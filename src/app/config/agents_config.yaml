# =============================================================
# src/app/config/agents_config.yaml
# SINGLE SOURCE OF TRUTH for all 12 modules
# =============================================================

global:
  default_score: 70
  red_penalty: 10
  yellow_penalty: 5
  green_bonus: 1
  min_score: 0
  max_score: 100

modules:

  # 1. BORROWINGS MODULE
  borrowings:
    enabled: true
    name: "Borrowings"
    description: "Debt structure, leverage, maturity profile, and borrowing risk analysis"
    agent_prompt: |
      You are a senior credit analyst specializing in debt and leverage analysis.
      Analyze the company's borrowing structure, debt sustainability, maturity profile,
      interest rate risk, and overall leverage risks. Provide insights on refinancing
      risk and debt servicing capacity.
    output_sections: ["Leverage assessment", "Debt structure", "Maturity profile", "Interest rate risk", "Key concerns", "Positives", "Conclusion"]
    input_fields: [short_term_debt, long_term_debt, total_equity, ebitda, ebit, finance_cost, revenue, capex, cwip, total_debt_maturing_lt_1y, total_debt_maturing_1_3y, total_debt_maturing_gt_3y, weighted_avg_interest_rate, floating_rate_debt, fixed_rate_debt, interest_expense, total_debt]
    computed_fields:
      total_debt: ["short_term_debt + long_term_debt + (lease_liabilities or 0)"]
      ebit: ["operating_profit"]
      finance_cost: ["interest"]
      ebitda: ["operating_profit + (depreciation or 0)"]
      revenue: ["revenue or 0"]
    benchmarks:
      de_high: 1.0
      de_moderate: 0.5
      debt_ebitda_high: 4.0
      debt_ebitda_moderate: 2.0
      icr_low: 1.5
      icr_moderate: 3.0
      floating_high: 0.60
      floating_moderate: 0.40
      wacd_high: 0.10
      wacd_moderate: 0.07
      refinancing_high: 0.50
    metrics:
      total_debt: "short_term_debt + long_term_debt"
      de_ratio: "total_debt / total_equity"
      debt_ebitda: "total_debt / ebitda"
      interest_coverage: "ebit / finance_cost"
      st_debt_share: "short_term_debt / total_debt"
      floating_share: "floating_rate_debt"
      wacd: "weighted_avg_interest_rate"
      maturity_lt_1y_pct: "total_debt_maturing_lt_1y / total_debt"
      maturity_1_3y_pct: "total_debt_maturing_1_3y / total_debt"
      maturity_gt_3y_pct: "total_debt_maturing_gt_3y / total_debt"
      cwip_to_assets: "cwip / (total_equity + total_debt)"
    trends: [debt_cagr, ebitda_cagr, lt_debt_cagr, revenue_cagr, finance_cost_cagr, st_debt_yoy_growth]
    rules:
      # A. Debt Growth & Trend Rules
      - id: A1
        name: "Debt CAGR vs EBITDA CAGR"
        metric: debt_vs_ebitda_cagr
        red: "> 0"
        yellow: "-"
        green: "<= 0"
        insights:
          red:
            summary: "Debt growing faster than earnings capacity"
            implication: "Company is accumulating debt faster than its ability to service it. This trajectory is unsustainable and may lead to credit stress."
            investor_action: "Monitor credit rating outlook, check covenants, assess management's deleveraging plan."
            risk_level: "High"
          green:
            summary: "Healthy debt-to-earnings trajectory"
            implication: "Earnings growth outpacing debt growth indicates improving debt serviceability and financial flexibility."
            investor_action: "Positive signal; company has capacity for strategic investments or shareholder returns."
            risk_level: "Low"
      - id: A3
        name: "LT Debt Up, Revenue Flat"
        metric: lt_debt_vs_revenue
        red: "-"
        yellow: "> 0"
        green: "<= 0"
        insights:
          yellow:
            summary: "Long-term debt growing without revenue growth"
            implication: "Debt is being used for non-revenue generating purposes or expansion hasn't translated to sales yet."
            investor_action: "Investigate use of proceeds - is it for expansion, acquisitions, or refinancing?"
            risk_level: "Medium"
          green:
            summary: "Revenue growth supporting debt levels"
            implication: "Debt is being used productively to grow the business."
            investor_action: "Healthy indicator; monitor execution of growth strategy."
            risk_level: "Low"
      - id: A3b
        name: "Capex Funded by Debt"
        metric: cwip_to_assets
        red: "-"
        yellow: "-"
        green: "> 0.10"
        insights:
          green:
            summary: "Active capital investments underway"
            implication: "Significant CWIP indicates ongoing expansion. Check if funded prudently and expected ROI timeline."
            investor_action: "Review management commentary on project timelines and expected returns."
            risk_level: "Low"
      # B. Leverage Ratios
      - id: B1
        name: "Debt-to-Equity Ratio"
        metric: de_ratio
        red: "> 1.0"
        yellow: "> 0.5"
        green: "<= 0.5"
        insights:
          red:
            summary: "Highly leveraged balance sheet"
            implication: "Debt exceeds equity, indicating significant financial risk. Vulnerable to interest rate shocks and earnings volatility."
            investor_action: "Assess refinancing risk, check for upcoming maturities, review debt covenants."
            risk_level: "High"
            peer_context: "Most investment-grade companies maintain D/E below 1.0x"
          yellow:
            summary: "Moderate leverage levels"
            implication: "Leverage is manageable but warrants monitoring. Limited cushion for unexpected downturns."
            investor_action: "Monitor quarterly for any increase in leverage or deterioration in earnings."
            risk_level: "Medium"
          green:
            summary: "Conservative capital structure"
            implication: "Strong equity base provides cushion against volatility. Company has capacity for strategic borrowing if needed."
            investor_action: "Positive; consider if company is under-leveraged and missing growth opportunities."
            risk_level: "Low"
      - id: B2
        name: "Debt-to-EBITDA"
        metric: debt_ebitda
        red: "> 4.0"
        yellow: "> 2.0"
        green: "<= 2.0"
        insights:
          red:
            summary: "Very high leverage relative to cash generation"
            implication: "Would take 4+ years of EBITDA to repay debt. High refinancing risk and limited financial flexibility."
            investor_action: "Review debt maturity schedule urgently. Check if any covenant breaches are imminent."
            risk_level: "High"
            peer_context: "Rating agencies typically consider >4x as highly speculative"
          yellow:
            summary: "Elevated but manageable leverage"
            implication: "2-4 years of earnings needed to repay debt. May face pressure during economic downturns."
            investor_action: "Monitor EBITDA trends closely. Any earnings decline will worsen this ratio."
            risk_level: "Medium"
          green:
            summary: "Strong debt coverage"
            implication: "Can repay all debt within 2 years of cash generation. Strong position for growth or shareholder returns."
            investor_action: "Favorable credit profile; attractive for lenders and credit upgrade potential."
            risk_level: "Low"
      # C. Interest Coverage Rules
      - id: C1
        name: "Interest Coverage Ratio"
        metric: interest_coverage
        red: "< 1.5"
        yellow: "< 3.0"
        green: ">= 3.0"
        insights:
          red:
            summary: "Critical - earnings barely cover interest"
            implication: "Company is at risk of missing interest payments. Any earnings decline could trigger default."
            investor_action: "HIGH ALERT: Review liquidity position, check for covenant waivers, assess restructuring risk."
            risk_level: "Critical"
            peer_context: "ICR below 1.5x is considered distressed by most credit analysts"
          yellow:
            summary: "Tight interest coverage"
            implication: "Limited margin of safety. Earnings decline of 30-50% could stress debt servicing."
            investor_action: "Monitor earnings stability, check for any refinancing at higher rates."
            risk_level: "Medium"
          green:
            summary: "Comfortable interest coverage"
            implication: "Strong earnings cushion to service debt. Can absorb earnings volatility without stress."
            investor_action: "Healthy indicator; supports credit quality and borrowing capacity."
            risk_level: "Low"
      - id: C2
        name: "Finance Cost vs Debt Growth"
        metric: finance_cost_vs_debt
        red: "-"
        yellow: "> 5.0"
        green: "<= 5.0"
        insights:
          yellow:
            summary: "Interest costs growing faster than debt"
            implication: "Either refinancing at higher rates or floating rate exposure is hurting. Margin compression ahead."
            investor_action: "Check fixed vs floating debt mix. Review recent refinancing terms."
            risk_level: "Medium"
          green:
            summary: "Interest costs under control"
            implication: "Company is managing borrowing costs well. May benefit from favorable refinancing."
            investor_action: "Positive trend; supports margin stability."
            risk_level: "Low"
      # D. Maturity Profile Rules
      - id: D1
        name: "Refinancing Risk"
        metric: maturity_lt_1y_pct
        red: "> 0.50"
        yellow: "> 0.30"
        green: "<= 0.30"
        insights:
          red:
            summary: "High near-term refinancing burden"
            implication: "Over 50% of debt due within 1 year. Significant refinancing risk, especially if credit markets tighten."
            investor_action: "URGENT: Assess liquidity sources, review committed credit lines, check bank relationships."
            risk_level: "High"
          yellow:
            summary: "Moderate refinancing needs"
            implication: "30-50% debt due within a year needs proactive management."
            investor_action: "Monitor refinancing progress and terms. Check available liquidity."
            risk_level: "Medium"
          green:
            summary: "Well-laddered debt maturity"
            implication: "Minimal near-term pressure. Company has time to plan refinancing optimally."
            investor_action: "Favorable maturity profile; reduces execution risk."
            risk_level: "Low"
      - id: D2
        name: "Balanced Maturity"
        metric: maturity_balance
        red: "-"
        yellow: "-"
        green: "> 0"
        insights:
          green:
            summary: "Well-diversified maturity schedule"
            implication: "Debt spread across different tenors reduces bullet payment risk and provides flexibility."
            investor_action: "Positive; indicates proactive treasury management."
            risk_level: "Low"
      # E. Interest Rate Risk
      - id: E1
        name: "Floating Rate Exposure"
        metric: floating_share
        red: "> 0.60"
        yellow: "> 0.40"
        green: "<= 0.40"
        insights:
          red:
            summary: "High sensitivity to interest rate changes"
            implication: "Over 60% floating rate debt means every 1% rate increase significantly impacts finance costs."
            investor_action: "Model P&L impact of rate hikes. Check for hedging instruments."
            risk_level: "High"
          yellow:
            summary: "Moderate interest rate exposure"
            implication: "Balanced but some vulnerability to rate increases."
            investor_action: "Monitor central bank policy and company's hedging strategy."
            risk_level: "Medium"
          green:
            summary: "Well-hedged interest rate position"
            implication: "Predominantly fixed rate debt provides cost predictability."
            investor_action: "Favorable; finance costs are predictable for planning."
            risk_level: "Low"
      # F. Cost of Debt
      - id: F1
        name: "Weighted Avg Cost of Debt"
        metric: wacd
        red: "> 0.10"
        yellow: "> 0.07"
        green: "<= 0.07"
        insights:
          red:
            summary: "High borrowing costs"
            implication: "Above 10% cost of debt suggests either poor credit quality or unfavorable terms. Compresses margins significantly."
            investor_action: "Compare with peers. Check if refinancing opportunities exist at better rates."
            risk_level: "High"
            peer_context: "Investment-grade companies typically borrow at 5-8%"
          yellow:
            summary: "Moderate borrowing costs"
            implication: "7-10% is acceptable for many sectors but limits ROI on leveraged investments."
            investor_action: "Monitor vs peer group. Look for refinancing opportunities."
            risk_level: "Medium"
          green:
            summary: "Favorable borrowing terms"
            implication: "Low cost of debt indicates strong credit profile and/or favorable market timing."
            investor_action: "Competitive advantage; supports returns on capital-intensive projects."
            risk_level: "Low"

  # 2. EQUITY & FUNDING MIX MODULE
  equity_funding_mix:
    enabled: true
    name: "EquityFundingMix"
    description: "Equity quality, retained earnings, dividend policy, and funding mix"
    agent_prompt: |
      You are a senior equity analyst. Evaluate equity quality, retained earnings, 
      dividend sustainability, ROE, funding mix, and dilution risks.
    output_sections: ["Equity quality", "Retained earnings", "Dividend policy", "ROE", "Funding mix", "Concerns", "Positives"]
    input_fields: [share_capital, reserves_and_surplus, net_worth, pat, dividend_paid, free_cash_flow, new_share_issuance, debt_equitymix]
    computed_fields:
      debt: ["short_term_debt + long_term_debt + (lease_liabilities or 0)"]
      share_capital: ["equity_capital or total_equity"]
      reserves_and_surplus: ["reserves or 0"]
      net_worth: ["share_capital + reserves_and_surplus"]
      pat: ["net_profit"]
      dividends_paid: ["dividends_paid or 0"]
      free_cash_flow: ["cash_from_operating_activity + fixed_assets_purchased"]
      revenue: ["revenue or 0"]
    benchmarks:
      payout_high: 0.50
      roe_good: 0.15
      roe_modest: 0.10
      dilution_high: 0.10
    metrics:
      retained_earnings: "reserves_and_surplus"
      dividend_payout_ratio: "abs(dividend_paid) / pat"
      dividend_to_fcf: "abs(dividend_paid) / free_cash_flow"
      roe: "pat / avg_equity"
      equity_dilution_pct: "new_share_issuance / prior_share_capital"
      debt_to_equity: "debt_equitymix / net_worth"
      equity_ratio: "net_worth / (net_worth + debt_equitymix)"
    trends: [retained_earnings_cagr, networth_cagr, pat_cagr, equity_cagr, debt_cagr]
    rules:
      - id: A1
        name: "Retained Earnings Growth"
        metric: re_growth_yoy
        red: "< 0"
        yellow: "< 0.05"
        green: ">= 0.05"
        insights:
          red:
            summary: "Declining retained earnings"
            implication: "Company is consuming more cash than it generates, or paying out more than it earns. Reduces internal funding capacity."
            investor_action: "Check for one-time losses, aggressive dividends, or sustained operating losses. Review sustainability of capital allocation."
            risk_level: "High"
          yellow:
            summary: "Slow retained earnings growth"
            implication: "Internal accrual is positive but modest. May need external funding for major expansions."
            investor_action: "Monitor PAT growth and dividend policy. Assess if payout is too high."
            risk_level: "Medium"
          green:
            summary: "Strong retained earnings accumulation"
            implication: "Company is building equity base through profits. Self-funding capability is improving."
            investor_action: "Positive signal; supports future growth without dilution or debt."
            risk_level: "Low"
      - id: B1
        name: "Return on Equity"
        metric: roe
        red: "< 0.10"
        yellow: "< 0.15"
        green: ">= 0.15"
        insights:
          red:
            summary: "Subpar returns on shareholder capital"
            implication: "Returns below 10% often trail cost of equity. Value destruction risk if sustained."
            investor_action: "Compare with peers and industry average. Check if ROE is depressed by one-time items."
            risk_level: "High"
            peer_context: "Most quality companies maintain ROE above 15%"
          yellow:
            summary: "Moderate but improvable ROE"
            implication: "Acceptable returns but room for improvement through margin expansion or better asset turnover."
            investor_action: "Monitor for improving trends. Check management's ROE improvement initiatives."
            risk_level: "Medium"
          green:
            summary: "Strong shareholder value creation"
            implication: "Returns well above cost of equity. Company is creating value for shareholders."
            investor_action: "Premium valuation justified. Check for consistency across cycles."
            risk_level: "Low"
      - id: C1
        name: "Dividend Payout"
        metric: dividend_payout_ratio
        red: "> 1.0"
        yellow: "> 0.50"
        green: "<= 0.50"
        insights:
          red:
            summary: "Unsustainable dividend - paying more than earned"
            implication: "Payout exceeds 100% of profits. Either dipping into reserves or borrowing for dividends. Not sustainable."
            investor_action: "ALERT: Expect dividend cut ahead. Check if special dividend or one-time occurrence."
            risk_level: "Critical"
          yellow:
            summary: "High but potentially sustainable payout"
            implication: "Paying out 50-100% of profits limits reinvestment capacity. Suitable for mature, stable businesses."
            investor_action: "Assess growth needs. High payout okay if business is mature with limited capex needs."
            risk_level: "Medium"
          green:
            summary: "Balanced dividend with retained growth"
            implication: "Retaining majority of earnings for growth while providing shareholder returns. Healthy balance."
            investor_action: "Favorable; company balancing growth and income. Check dividend growth track record."
            risk_level: "Low"
      - id: D1
        name: "Equity Dilution"
        metric: equity_dilution_pct
        red: "> 0.10"
        yellow: "> 0.05"
        green: "<= 0.05"
        insights:
          red:
            summary: "Significant equity dilution"
            implication: "Share capital increased by >10%. Existing shareholders' ownership significantly reduced. Check valuation at issuance."
            investor_action: "Review reason for issuance - growth funding, deleveraging, or distress? Was it at fair value?"
            risk_level: "High"
          yellow:
            summary: "Moderate dilution"
            implication: "5-10% dilution is notable. Check if EPS growth will offset ownership dilution."
            investor_action: "Verify use of proceeds and expected returns vs dilution cost."
            risk_level: "Medium"
          green:
            summary: "Minimal shareholder dilution"
            implication: "Limited equity issuance preserves existing shareholders' ownership and EPS."
            investor_action: "Positive; company is funding growth without excessive dilution."
            risk_level: "Low"
      - id: E1
        name: "Debt-to-Equity"
        metric: debt_to_equity
        red: "> 1.5"
        yellow: "> 1.0"
        green: "<= 1.0"
        insights:
          red:
            summary: "Debt-heavy capital structure"
            implication: "Debt is 1.5x+ equity. Financial risk is elevated. Vulnerable to interest rate shocks."
            investor_action: "Check interest coverage, assess refinancing risk, review deleveraging plans."
            risk_level: "High"
          yellow:
            summary: "Leveraged but manageable"
            implication: "Equal or slightly higher debt than equity. Watch for deterioration."
            investor_action: "Monitor quarterly. Check if leverage is for growth or covering operating shortfalls."
            risk_level: "Medium"
          green:
            summary: "Equity-dominated capital structure"
            implication: "Strong equity base provides stability. Can access debt markets if needed for growth."
            investor_action: "Favorable; company has financial flexibility for opportunities."
            risk_level: "Low"

  # 3. LIQUIDITY MODULE
  # liquidity:
  #   enabled: true
  #   name: "Liquidity"
  #   description: "Short-term liquidity, cash position, and working capital"
  #   agent_prompt: |
  #     You are a liquidity analyst. Evaluate short-term solvency, cash adequacy, and working capital.
  #   output_sections: ["Liquidity overview", "Cash position", "Working capital", "Concerns", "Assessment"]
  #   input_fields: [cash_and_equivalents, marketable_securities, current_assets, current_liabilities, inventory, total_debt, daily_operating_expenses]
  #   benchmarks:
  #     current_ratio_low: 1.0
  #     quick_ratio_low: 0.8
  #     cash_ratio_low: 0.2
  #   metrics:
  #     current_ratio: "current_assets / current_liabilities"
  #     quick_ratio: "(current_assets - inventory) / current_liabilities"
  #     cash_ratio: "(cash_and_equivalents + marketable_securities) / current_liabilities"
  #     cash_coverage_days: "cash_and_equivalents / daily_operating_expenses"
  #   rules:
  #     - id: L1
  #       name: "Current Ratio"
  #       metric: current_ratio
  #       red: "< 1.0"
  #       yellow: "< 1.5"
  #       green: ">= 1.5"
  #     - id: L2
  #       name: "Cash Coverage Days"
  #       metric: cash_coverage_days
  #       red: "< 30"
  #       yellow: "< 90"
  #       green: ">= 90"

  # # 4. WORKING CAPITAL MODULE
  # working_capital:
  #   enabled: true
  #   name: "WorkingCapital"
  #   description: "Working capital efficiency and cash conversion cycle"
  #   agent_prompt: |
  #     You are a working capital analyst. Evaluate inventory, receivables, payables, and cash conversion.
  #   output_sections: ["WC overview", "Cash cycle", "Efficiency", "Concerns", "Recommendations"]
  #   input_fields: [trade_receivables, trade_payables, inventory_wc, revenue_wc, cogs]
  #   benchmarks:
  #     dso_high: 90
  #     dio_high: 120
  #     ccc_high: 90
  #   metrics:
  #     dso: "(trade_receivables / revenue_wc) * 365"
  #     dio: "(inventory_wc / cogs) * 365"
  #     dpo: "(trade_payables / cogs) * 365"
  #     cash_conversion_cycle: "dso + dio - dpo"
  #   rules:
  #     - id: W1
  #       name: "Cash Conversion Cycle"
  #       metric: cash_conversion_cycle
  #       red: "> 90"
  #       yellow: "> 60"
  #       green: "<= 60"
  #     - id: W2
  #       name: "Days Sales Outstanding"
  #       metric: dso
  #       red: "> 90"
  #       yellow: "> 60"
  #       green: "<= 60"

  # # 5. CAPEX & ASSET QUALITY MODULE
  # capex_asset_quality:
  #   enabled: true
  #   name: "CapexAssetQuality"
  #   description: "Capital expenditure efficiency and asset quality"
  #   agent_prompt: |
  #     You are a capital allocation analyst. Evaluate capex efficiency, asset utilization, and quality.
  #   output_sections: ["Capex analysis", "Asset utilization", "Asset quality", "Concerns", "Recommendations"]
  #   input_fields: [net_fixed_assets, gross_block, accumulated_depreciation, cwip_asset, capex, revenue, operating_cash_flow, intangibles, goodwill]
  #   benchmarks:
  #     asset_turnover_low: 0.5
  #     capex_ocf_high: 1.0
  #   metrics:
  #     asset_turnover: "revenue / net_fixed_assets"
  #     capex_to_revenue: "capex / revenue"
  #     capex_to_ocf: "capex / operating_cash_flow"
  #     asset_age_ratio: "accumulated_depreciation / gross_block"
  #     cwip_ratio: "cwip_asset / gross_block"
  #   rules:
  #     - id: C1
  #       name: "Asset Turnover"
  #       metric: asset_turnover
  #       red: "< 0.5"
  #       yellow: "< 1.0"
  #       green: ">= 1.0"
  #     - id: C2
  #       name: "Capex to OCF"
  #       metric: capex_to_ocf
  #       red: "> 1.0"
  #       yellow: "> 0.75"
  #       green: "<= 0.75"

  # # 6. PROFITABILITY MODULE
  # profitability:
  #   enabled: true
  #   name: "Profitability"
  #   description: "Margin analysis and earnings quality"
  #   agent_prompt: |
  #     You are a profitability analyst. Evaluate margin trends, earnings quality, and efficiency.
  #   output_sections: ["Margin analysis", "Earnings quality", "Trends", "Concerns", "Outlook"]
  #   input_fields: [revenue, ebitda, ebit, pat, operating_cash_flow]
  #   metrics:
  #     ebitda_margin: "ebitda / revenue"
  #     ebit_margin: "ebit / revenue"
  #     pat_margin: "pat / revenue"
  #     ocf_to_pat: "operating_cash_flow / pat"
  #   rules:
  #     - id: P1
  #       name: "EBITDA Margin"
  #       metric: ebitda_margin
  #       red: "< 0.10"
  #       yellow: "< 0.15"
  #       green: ">= 0.15"
  #     - id: P2
  #       name: "Cash Earnings Quality"
  #       metric: ocf_to_pat
  #       red: "< 0.50"
  #       yellow: "< 0.80"
  #       green: ">= 0.80"

  # # 7. CASH FLOW MODULE
  # cash_flow:
  #   enabled: true
  #   name: "CashFlow"
  #   description: "Cash flow quality and sustainability"
  #   agent_prompt: |
  #     You are a cash flow analyst. Evaluate OCF, FCF, and cash allocation.
  #   output_sections: ["OCF analysis", "FCF assessment", "Cash allocation", "Concerns", "Sustainability"]
  #   input_fields: [operating_cash_flow, capex, free_cash_flow, pat, total_debt]
  #   metrics:
  #     fcf: "operating_cash_flow - capex"
  #     fcf_margin: "fcf / revenue"
  #     ocf_to_debt: "operating_cash_flow / total_debt"
  #     fcf_to_pat: "fcf / pat"
  #   rules:
  #     - id: CF1
  #       name: "Free Cash Flow"
  #       metric: fcf
  #       red: "< 0"
  #       yellow: "declining"
  #       green: ">= 0 and growing"
  #     - id: CF2
  #       name: "OCF to Debt"
  #       metric: ocf_to_debt
  #       red: "< 0.15"
  #       yellow: "< 0.25"
  #       green: ">= 0.25"

  # # 8. SOLVENCY MODULE
  # solvency:
  #   enabled: true
  #   name: "Solvency"
  #   description: "Long-term solvency and financial stability"
  #   agent_prompt: |
  #     You are a solvency analyst. Evaluate long-term stability and debt sustainability.
  #   output_sections: ["Solvency overview", "Debt sustainability", "Capital structure", "Risks", "Outlook"]
  #   input_fields: [total_assets, total_liabilities, total_equity, long_term_debt, ebitda, interest_expense]
  #   metrics:
  #     equity_to_assets: "total_equity / total_assets"
  #     debt_to_assets: "total_liabilities / total_assets"
  #     lt_debt_to_equity: "long_term_debt / total_equity"
  #   rules:
  #     - id: S1
  #       name: "Equity to Assets"
  #       metric: equity_to_assets
  #       red: "< 0.30"
  #       yellow: "< 0.40"
  #       green: ">= 0.40"

  # # 9. VALUATION MODULE
  # valuation:
  #   enabled: true
  #   name: "Valuation"
  #   description: "Relative and intrinsic valuation metrics"
  #   agent_prompt: |
  #     You are a valuation analyst. Evaluate relative valuation and market expectations.
  #   output_sections: ["Valuation overview", "Relative metrics", "Historical", "Observations", "Conclusion"]
  #   input_fields: [market_cap, share_price, pat, book_value, ebitda, revenue, free_cash_flow, dividends_per_share]
  #   metrics:
  #     pe_ratio: "market_cap / pat"
  #     pb_ratio: "market_cap / book_value"
  #     ev_ebitda: "(market_cap + debt - cash) / ebitda"
  #     fcf_yield: "free_cash_flow / market_cap"
  #   rules:
  #     - id: V1
  #       name: "P/E Ratio"
  #       metric: pe_ratio
  #       red: "> 40"
  #       yellow: "> 25"
  #       green: "<= 25"

  # # 10. GROWTH MODULE
  # growth:
  #   enabled: true
  #   name: "Growth"
  #   description: "Revenue and earnings growth analysis"
  #   agent_prompt: |
  #     You are a growth analyst. Evaluate revenue and earnings trajectory.
  #   output_sections: ["Growth overview", "Revenue trajectory", "Earnings momentum", "Sustainability", "Outlook"]
  #   input_fields: [revenue, pat, ebitda]
  #   metrics:
  #     revenue_growth: "(revenue_t - revenue_t1) / revenue_t1"
  #     pat_growth: "(pat_t - pat_t1) / pat_t1"
  #     ebitda_growth: "(ebitda_t - ebitda_t1) / ebitda_t1"
  #   trends: [revenue_cagr, pat_cagr, ebitda_cagr]
  #   rules:
  #     - id: G1
  #       name: "Revenue CAGR"
  #       metric: revenue_cagr
  #       red: "< 0"
  #       yellow: "< 0.10"
  #       green: ">= 0.10"

  # # 11. RISK ASSESSMENT MODULE
  # risk_assessment:
  #   enabled: true
  #   name: "RiskAssessment"
  #   description: "Financial and operational risk evaluation"
  #   agent_prompt: |
  #     You are a risk analyst. Evaluate financial leverage, operational risk, and overall risk.
  #   output_sections: ["Risk overview", "Financial risk", "Operational risk", "Mitigation", "Rating"]
  #   input_fields: [risk_ebit, risk_interest, risk_net_income, risk_operating_cash_flow, risk_capex, risk_fixed_assets, risk_net_debt, risk_revenue, risk_assets_total]
  #   metrics:
  #     financial_leverage: "risk_assets_total / equity"
  #     interest_burden: "risk_interest / risk_ebit"
  #     capex_intensity: "risk_capex / risk_revenue"
  #   rules:
  #     - id: R1
  #       name: "Financial Leverage"
  #       metric: financial_leverage
  #       red: "> 3.0"
  #       yellow: "> 2.0"
  #       green: "<= 2.0"

  # # 12. CREDIT RATING MODULE
  # credit_rating:
  #   enabled: true
  #   name: "CreditRating"
  #   description: "Credit quality and rating assessment"
  #   agent_prompt: |
  #     You are a credit rating analyst. Assess creditworthiness and implied rating.
  #   output_sections: ["Credit overview", "Key metrics", "Strengths", "Weaknesses", "Rating"]
  #   input_fields: [total_debt, ebitda, interest_expense, operating_cash_flow, total_equity]
  #   metrics:
  #     debt_ebitda: "total_debt / ebitda"
  #     ebitda_interest: "ebitda / interest_expense"
  #     ffo_debt: "(ocf + interest) / total_debt"
  #   rules:
  #     - id: CR1
  #       name: "Debt to EBITDA"
  #       metric: debt_ebitda
  #       red: "> 5.0"
  #       yellow: "> 3.0"
  #       green: "<= 3.0"
  #     - id: CR2
  #       name: "Interest Coverage"
  #       metric: ebitda_interest
  #       red: "< 2.0"
  #       yellow: "< 4.0"
  #       green: ">= 4.0"
